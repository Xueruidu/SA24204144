<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Xuerui Du" />

<meta name="date" content="2024-12-08" />

<title>Summary of Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Summary of Homework</h1>
<h4 class="author">Xuerui Du</h4>
<h4 class="date">2024-12-08</h4>



<div id="homework-2024.09.09" class="section level2">
<h2>Homework-2024.09.09</h2>
<div id="question" class="section level3">
<h3>Question</h3>
<ol style="list-style-type: decimal">
<li><p>Go through “R for Beginners” if you are not familiar with R
programming.</p></li>
<li><p>Use knitr to produce at least 3 examples. For each example, texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p></li>
</ol>
</div>
<div id="answer" class="section level3">
<h3>Answer</h3>
<ol style="list-style-type: decimal">
<li><p>I’m familiar with R programming.</p></li>
<li></li>
</ol>
<p>1)Assuming that <span class="math inline">\({X}\)</span> obeys the
standard normal distribution <span class="math inline">\(\mathcal{N}(0,1)\)</span> and <span class="math inline">\({Y}\)</span> obeys the distribution, then the
distribution <span class="math inline">\(\chi^2(n)\)</span>.Then <span class="math inline">\({Z}=\frac{{X}}{\sqrt{Y/n}}\)</span> is called the
<span class="math inline">\(t\)</span>-distribution with degrees of
freedom <span class="math inline">\(n\)</span> and is denoted as <span class="math inline">\(Z \sim t(n)\)</span>.</p>
<p>2)We toss the coin ten times repeatedly.Here is the result.</p>
<table>
<thead>
<tr class="header">
<th align="center">No.</th>
<th align="center">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">H</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">T</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">H</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">T</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">T</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">H</td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="center">T</td>
</tr>
<tr class="even">
<td align="center">8</td>
<td align="center">H</td>
</tr>
<tr class="odd">
<td align="center">9</td>
<td align="center">H</td>
</tr>
<tr class="even">
<td align="center">10</td>
<td align="center">T</td>
</tr>
</tbody>
</table>
<p>3)The general formula for the probability density function of the
normal distribution is <span class="math display">\[
f(x) = \frac{1} {\sqrt{2\pi}\sigma} e^{-(x - \mu)^{2}/(2\sigma^{2}) }.
\]</span> The following is the plot of the standard normal probability
density function.</p>
</div>
</div>
<div id="homework-2024.09.14" class="section level2">
<h2>Homework-2024.09.14</h2>
<div id="question-1" class="section level3">
<h3>Question</h3>
<ol style="list-style-type: decimal">
<li><p>The Rayleigh density [156, Ch. 18] is <span class="math display">\[
f(x) = \frac{x}{\sigma^2} e^{−x^2/(2\sigma^2)} \qquad x ≥ 0,σ&gt; 0.
\]</span> Develop an algorithm to generate random samples from a
Rayleigh(<span class="math inline">\(σ\)</span>) distribution. Generate
Rayleigh(<span class="math inline">\(σ\)</span>) samples for several
choices of <span class="math inline">\(σ &gt; 0\)</span> and check that
the mode of the generated samples is close to the theoretical mode <span class="math inline">\(σ\)</span>(check the histogram).</p></li>
<li><p>Generate a random sample of size 1000 from a normal location
mixture. The components of the mixture have <span class="math inline">\(\mathcal{N}(0, 1)\)</span> and <span class="math inline">\(\mathcal{N}(3, 1)\)</span> distributions with
mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 = 1 − p_1\)</span>. Graph the histogram of the
sample with density superimposed, for <span class="math inline">\(p_1 =
0.75\)</span>. Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical
distribution of the mixture appears to be bimodal. Make a conjecture
about the values of <span class="math inline">\(p_1\)</span> that
produce bimodal mixtures.</p></li>
<li><p><span class="math inline">\(A \, compound \,  Poisson \,
process\)</span> is a stochastic process <span class="math inline">\(\{X(t), t ≥ 0\}\)</span> that can be represented
as the random sum <span class="math inline">\(X(t) = \sum^{N(t)}_{i=1}
Y_i, t ≥ 0\)</span>, where <span class="math inline">\(\{N(t), t ≥
0\}\)</span> is a Poisson process and <span class="math inline">\(Y_1,
Y_2,\dots\)</span> are iid and independent of <span class="math inline">\(\{N(t), t ≥ 0\}\)</span>.Write a program to
simulate a compound Poisson(<span class="math inline">\(λ\)</span>)–Gamma process (<span class="math inline">\(Y\)</span> has a Gamma distribution). Estimate the
mean and the variance of <span class="math inline">\(X(10)\)</span> for
several choices of the parameters and compare with the theoretical
values.</p></li>
</ol>
<p>Hint: Show that <span class="math inline">\(E[X(t)] =
λtE[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) =
λtE[Y_1^2]\)</span>.</p>
</div>
<div id="answer-1" class="section level3">
<h3>Answer</h3>
<ol style="list-style-type: decimal">
<li>To generate samples from the Rayleigh distribution using the inverse
transform method, we first need to calculate its corresponding
cumulative distribution function (CDF).</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
F(x) &amp;= \int_0^x f(x)dx \\
&amp;=\int_0^x \frac{x}{\sigma^2} e^{−x^2/(2\sigma^2)} dx \\
&amp;= 1-e^{−x^2/(2\sigma^2)}
\end{aligned}
\]</span></p>
<p>then, <span class="math display">\[
\begin{aligned}
u&amp;=F(x)\\
u&amp;=1-e^{−x^2/(2\sigma^2)} \\
e^{−x^2/(2\sigma^2)}&amp;=1-u \\
x^2 &amp;= -2\sigma^2 \cdot \log (1-u) \\
x&amp;= \sqrt{ -2\sigma^2 \cdot \log (1-u) }
\end{aligned}
\]</span></p>
<p>Then, according to the inverse transform method:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Generate a variable <span class="math inline">\(U \sim
U(0,1)\)</span>;</p></li>
<li><p>Obtain <span class="math inline">\(X=F_X^{-1}(U)\)</span>.</p></li>
</ol>
<p>Here, the values of <span class="math inline">\(\sigma\)</span> are
set to <span class="math inline">\(\{ 1,10,50,100,1000 \}\)</span>, and
the sample size is <span class="math inline">\(1000\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>invF <span class="ot">&lt;-</span> <span class="cf">function</span>(u,sigma){</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(  <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u) )</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,N)</span></code></pre></div>
<p>when <span class="math inline">\(\sigma=1\)</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">invF</span>(U,sigma)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">frac</span>(x, sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)},sigma<span class="sc">==</span><span class="dv">1</span>),<span class="at">breaks =</span> <span class="dv">10</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.65</span>))</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>when <span class="math inline">\(\sigma=10\)</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">invF</span>(U,sigma)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">frac</span>(x, sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)},sigma<span class="sc">==</span><span class="dv">10</span>),<span class="at">breaks =</span> <span class="dv">10</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.07</span>))</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="fl">0.01</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>when <span class="math inline">\(\sigma=50\)</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">invF</span>(U,sigma)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">frac</span>(x, sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)},sigma<span class="sc">==</span><span class="dv">50</span>),<span class="at">breaks =</span> <span class="dv">10</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.013</span>))</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">200</span>,<span class="fl">0.01</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>when <span class="math inline">\(\sigma=1000\)</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">invF</span>(U,sigma)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">frac</span>(x, sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)},<span class="at">sigma=</span><span class="dv">1000</span>),<span class="at">breaks =</span> <span class="dv">10</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.0006</span>))</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">4000</span>,<span class="fl">0.01</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>For a normal distribution <span class="math inline">\(\mathcal{N}(\mu,\sigma^2)\)</span>, its
probability density function is <span class="math display">\[
f(x;\mu,\sigma^2) = \frac{1}{\sqrt{2 \pi}\sigma} \exp (-
\frac{(x-\mu)^2}{2\sigma^2}).
\]</span></li>
</ol>
<p>In this problem, the probability density function is <span class="math display">\[
\begin{aligned}
f(x;p_1,p_2) &amp;= f(x|under \, model1)p(model1) + f(x|under \,
model2)p(model2) \\
&amp;= p_1 \cdot \frac{1}{\sqrt{2 \pi}} \exp (- \frac{x^2}{2}) + p_2
\cdot \frac{1}{\sqrt{2 \pi}} \exp (- \frac{(x-3)^2}{2}).
\end{aligned}
\]</span> when <span class="math inline">\(p_1=0.75\)</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>mixf <span class="ot">&lt;-</span> <span class="cf">function</span>(x,p1){</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="fu">return</span>( p1 <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span> (<span class="sc">-</span> (x<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) )</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>}</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),N,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>X <span class="ot">&lt;-</span> p<span class="sc">*</span>X1 <span class="sc">+</span> p<span class="sc">*</span>X2</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;p1=&quot;</span>,p1),<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">5</span>))</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="fu">mixf</span>(y,p1),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>when <span class="math inline">\(p_1 \in \{
0,0.125,0.25,0.375,0.50,0.625,0.75,0.875,1 \}\)</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="cf">for</span>(p1 <span class="cf">in</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>)<span class="sc">/</span><span class="dv">8</span>){</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),N,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  X <span class="ot">&lt;-</span> p<span class="sc">*</span>X1 <span class="sc">+</span> p<span class="sc">*</span>X2</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="fu">hist</span>(X,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;p1=&quot;</span>,p1),<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">5</span>))</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="fu">lines</span>(y,<span class="fu">mixf</span>(y,p1),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>}</span></code></pre></div>
<p>The figures show that when <span class="math inline">\(p_1\)</span>
is around <span class="math inline">\(0.25\)</span> to <span class="math inline">\(0.75\)</span>, a bimodal phenomenon exists. The
closer <span class="math inline">\(p_1\)</span> is to <span class="math inline">\(0.5\)</span>, the more pronounced the bimodal
phenomenon becomes.</p>
<ol start="3" style="list-style-type: decimal">
<li>It is known that <span class="math inline">\(Y_1,Y_2,\dots\)</span>
are iid and independent of <span class="math inline">\(\{N(t),t \geq
0\}\)</span>. <span class="math inline">\(Y\)</span> has a Gamma
distribution and <span class="math inline">\(\{N(t),t \geq 0\}\)</span>
is a Poisson(<span class="math inline">\(\lambda\)</span>) process, so
<span class="math display">\[
\begin{aligned}
E[X(t)]&amp;=E[E[X(t)|N(t)=n]] \\
&amp;=E[nE[Y_1]] \\
&amp;=E[Y_1] E[n] \\
&amp;=E[Y_1] E[N(t)] \\
&amp;=\lambda t E[Y_1]
\end{aligned}
\]</span></li>
</ol>
<p><span class="math display">\[
\begin{aligned}
Var(X(t)) &amp;= E[Var(X(t)|N(t)=n)] + Var(E[X(t)|N(t)=n]) \\
&amp;= E[nVar(Y_1)] + Var(nE[Y_1]) \\
&amp;= E[N(t)]Var(Y_1) + E[Y_1]^2Var(N(t)) \\
&amp;= \lambda t (E[Y_1^2]-E[Y_1]^2) + E[Y_1]^2 \lambda t \\
&amp;= \lambda t E[Y_1^2]
\end{aligned}
\]</span></p>
<p>We assume <span class="math inline">\(Y_i\sim
Gamma(\alpha,\beta)\)</span>,</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>X10 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(total)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="cf">for</span>(time <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total){</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1234</span><span class="sc">*</span>time)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>t)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N,<span class="at">shape =</span> alpha,<span class="at">scale =</span> beta)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  X10[time] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>}</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;when lambda=&quot;</span>,lambda,<span class="st">&quot;,alpha=&quot;</span>,alpha,<span class="st">&quot;,beta=&quot;</span>,beta))</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;the theoretical values:E[X(10)]=&quot;</span>,lambda<span class="sc">*</span>t<span class="sc">*</span>alpha<span class="sc">*</span>beta,<span class="st">&quot;,Var(x(10))=&quot;</span>,lambda<span class="sc">*</span>t<span class="sc">*</span>(alpha<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>alpha<span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span>),<span class="st">&quot;;&quot;</span>))</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;the empirical values:E[X(10)]=&quot;</span>,<span class="fu">mean</span>(X10),<span class="st">&quot;,Var(x(10))=&quot;</span>,<span class="fu">var</span>(X10),<span class="st">&quot;;&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>X10 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(total)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="cf">for</span>(time <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total){</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1234</span><span class="sc">*</span>time)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>t)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N,<span class="at">shape =</span> alpha,<span class="at">scale =</span> beta)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  X10[time] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>}</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;when lambda=&quot;</span>,lambda,<span class="st">&quot;,alpha=&quot;</span>,alpha,<span class="st">&quot;,beta=&quot;</span>,beta))</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;the theoretical values:E[X(10)]=&quot;</span>,lambda<span class="sc">*</span>t<span class="sc">*</span>alpha<span class="sc">*</span>beta,<span class="st">&quot;,Var(x(10))=&quot;</span>,lambda<span class="sc">*</span>t<span class="sc">*</span>(alpha<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>alpha<span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span>),<span class="st">&quot;;&quot;</span>))</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;the empirical values:E[X(10)]=&quot;</span>,<span class="fu">mean</span>(X10),<span class="st">&quot;,Var(x(10))=&quot;</span>,<span class="fu">var</span>(X10),<span class="st">&quot;;&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>X10 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(total)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="cf">for</span>(time <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total){</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1234</span><span class="sc">*</span>time)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>t)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N,<span class="at">shape =</span> alpha,<span class="at">scale =</span> beta)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  X10[time] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>}</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;when lambda=&quot;</span>,lambda,<span class="st">&quot;,alpha=&quot;</span>,alpha,<span class="st">&quot;,beta=&quot;</span>,beta))</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;the theoretical values:E[X(10)]=&quot;</span>,lambda<span class="sc">*</span>t<span class="sc">*</span>alpha<span class="sc">*</span>beta,<span class="st">&quot;,Var(x(10))=&quot;</span>,lambda<span class="sc">*</span>t<span class="sc">*</span>(alpha<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>alpha<span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span>),<span class="st">&quot;;&quot;</span>))</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;the empirical values:E[X(10)]=&quot;</span>,<span class="fu">mean</span>(X10),<span class="st">&quot;,Var(x(10))=&quot;</span>,<span class="fu">var</span>(X10),<span class="st">&quot;;&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>X10 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(total)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="cf">for</span>(time <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total){</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1234</span><span class="sc">*</span>time)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>t)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N,<span class="at">shape =</span> alpha,<span class="at">scale =</span> beta)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>  X10[time] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>}</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;when lambda=&quot;</span>,lambda,<span class="st">&quot;,alpha=&quot;</span>,alpha,<span class="st">&quot;,beta=&quot;</span>,beta))</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;the theoretical values:E[X(10)]=&quot;</span>,lambda<span class="sc">*</span>t<span class="sc">*</span>alpha<span class="sc">*</span>beta,<span class="st">&quot;,Var(x(10))=&quot;</span>,lambda<span class="sc">*</span>t<span class="sc">*</span>(alpha<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>alpha<span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span>),<span class="st">&quot;;&quot;</span>))</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;the empirical values:E[X(10)]=&quot;</span>,<span class="fu">mean</span>(X10),<span class="st">&quot;,Var(x(10))=&quot;</span>,<span class="fu">var</span>(X10),<span class="st">&quot;;&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>X10 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(total)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="cf">for</span>(time <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total){</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1234</span><span class="sc">*</span>time)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>t)</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N,<span class="at">shape =</span> alpha,<span class="at">scale =</span> beta)</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  X10[time] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>}</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;when lambda=&quot;</span>,lambda,<span class="st">&quot;,alpha=&quot;</span>,alpha,<span class="st">&quot;,beta=&quot;</span>,beta))</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;the theoretical values:E[X(10)]=&quot;</span>,lambda<span class="sc">*</span>t<span class="sc">*</span>alpha<span class="sc">*</span>beta,<span class="st">&quot;,Var(x(10))=&quot;</span>,lambda<span class="sc">*</span>t<span class="sc">*</span>(alpha<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>alpha<span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span>),<span class="st">&quot;;&quot;</span>))</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;the empirical values:E[X(10)]=&quot;</span>,<span class="fu">mean</span>(X10),<span class="st">&quot;,Var(x(10))=&quot;</span>,<span class="fu">var</span>(X10),<span class="st">&quot;;&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>X10 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(total)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="cf">for</span>(time <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total){</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1234</span><span class="sc">*</span>time)</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>t)</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N,<span class="at">shape =</span> alpha,<span class="at">scale =</span> beta)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  X10[time] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>}</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;when lambda=&quot;</span>,lambda,<span class="st">&quot;,alpha=&quot;</span>,alpha,<span class="st">&quot;,beta=&quot;</span>,beta))</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;the theoretical values:E[X(10)]=&quot;</span>,lambda<span class="sc">*</span>t<span class="sc">*</span>alpha<span class="sc">*</span>beta,<span class="st">&quot;,Var(x(10))=&quot;</span>,lambda<span class="sc">*</span>t<span class="sc">*</span>(alpha<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>alpha<span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span>),<span class="st">&quot;;&quot;</span>))</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;the empirical values:E[X(10)]=&quot;</span>,<span class="fu">mean</span>(X10),<span class="st">&quot;,Var(x(10))=&quot;</span>,<span class="fu">var</span>(X10),<span class="st">&quot;;&quot;</span>))</span></code></pre></div>
<p>We can know that the empirical values of the simulation are close to
the theoretical values.</p>
</div>
</div>
<div id="homework-2024.09.23" class="section level2">
<h2>Homework-2024.09.23</h2>
<div id="question-2" class="section level3">
<h3>Question</h3>
<ol style="list-style-type: decimal">
<li><p>Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(Beta(3,3)\)</span> cdf, and use the function to
estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x=0.1,0.2,\dots,0.9\)</span>. Compare the
estimates with the values returned by the pbeta function in R.</p></li>
<li><p>The Rayleigh density [156,(18.76)] is <span class="math display">\[
f(x) = \frac{x}{\sigma^2} e^{−x^2/(2\sigma^2)} \qquad x ≥ 0,σ&gt; 0.
\]</span></p></li>
</ol>
<p>Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution, using antithetic
variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X^{&#39;}}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1,X_2\)</span>?</p>
<ol start="3" style="list-style-type: decimal">
<li>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\qquad x&gt;1.
\]</span></li>
</ol>
<p>Which of your two importance functions should produce the smaller
variance in estimating <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2} dx
\]</span> by importance sampling? Explain.</p>
<ol start="4" style="list-style-type: decimal">
<li>Monte Carlo experiment</li>
</ol>
<p>(a). For <span class="math inline">\(n=10^4,2\times 10^4,4\times
10^4,6\times 10^4,8\times 10^4\)</span>, apply the fast sorting
algorithm to randomly permuted numbers of <span class="math inline">\(1,\dots,n\)</span>.</p>
<p>(b). Calculate computation time averaged over <span class="math inline">\(100\)</span> simulations, denoted by <span class="math inline">\(a_n\)</span>.</p>
<p>(c). Regress <span class="math inline">\(a_n\)</span> on $t_n := n(n)
$, and graphically show the results(scatter plot and regression
line).</p>
</div>
<div id="answer-2" class="section level3">
<h3>Answer</h3>
<ol style="list-style-type: decimal">
<li>The probability density function of the <span class="math inline">\(Beta(\alpha,\beta)\)</span> distribution is given
by <span class="math display">\[
f(x)=\frac{1}{B(\alpha,\beta)} x^{\alpha-1}(1-x)^{\beta-1},\qquad
\alpha&gt;0,\beta&gt;0.
\]</span></li>
</ol>
<p>The cumulative distribution function can be expressed as <span class="math display">\[
\begin{aligned}
F(x) &amp;= \int_0^x f(u)du \\
&amp;= \int_0^x \frac{1}{B(\alpha,\beta)} u^{\alpha-1}(1-u)^{\beta-1}.
\end{aligned}
\]</span></p>
<p>The parameter we want to estimate is <span class="math display">\[
\theta=\int_0^x f(u)du=\int_0^x \frac{1}{x} \cdot xf(u)du = \mathbb{E}
[g(U)],
\]</span> where <span class="math inline">\(U \sim U(0,x)\)</span>,<span class="math inline">\(g(u)=xf(u)\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>Fhat <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">0</span>,x)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  gU <span class="ot">&lt;-</span> x <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">beta</span>(alpha,beta)<span class="sc">*</span>U<span class="sc">^</span>(alpha<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>U)<span class="sc">^</span>(beta<span class="dv">-1</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(gU))</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">10</span>){</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;when x = &quot;</span>,x,<span class="st">&quot;,the real F(x):&quot;</span>,<span class="fu">pbeta</span>(x,alpha,beta),<span class="st">&quot;,the estimated F(x):&quot;</span>,<span class="fu">Fhat</span>(x),<span class="st">&quot;.&quot;</span>))</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>}</span></code></pre></div>
<p>From the Monte Carlo results, we can see that our estimates are close
to the true values.</p>
<ol start="2" style="list-style-type: decimal">
<li>To generate samples from the Rayleigh distribution using the inverse
transform method, we first need to calculate its corresponding
cumulative distribution function (CDF).</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
F(x) &amp;= \int_0^x f(x)dx \\
&amp;=\int_0^x \frac{x}{\sigma^2} e^{−x^2/(2\sigma^2)} dx \\
&amp;= 1-e^{−x^2/(2\sigma^2)}
\end{aligned}
\]</span></p>
<p>then, <span class="math display">\[
\begin{aligned}
u&amp;=F(x)\\
u&amp;=1-e^{−x^2/(2\sigma^2)} \\
e^{−x^2/(2\sigma^2)}&amp;=1-u \\
x^2 &amp;= -2\sigma^2 \cdot \log (1-u) \\
x&amp;= \sqrt{ -2\sigma^2 \cdot \log (1-u) }
\end{aligned}
\]</span></p>
<p>Then, according to the inverse transform method:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Generate a variable <span class="math inline">\(U \sim
U(0,1)\)</span>,<span class="math inline">\(U^{&#39;}=1-U\)</span>;</p></li>
<li><p>Obtain <span class="math inline">\(X=F_X^{-1}(U)\)</span>,<span class="math inline">\(X^{&#39;}=F_X^{-1}(U^{&#39;})\)</span>.</p></li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>invF <span class="ot">&lt;-</span> <span class="cf">function</span>(u,sigma){</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(  <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u) )</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>}</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,N<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,N<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,N)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">invF</span>(U[<span class="dv">1</span><span class="sc">:</span>(N<span class="sc">/</span><span class="dv">2</span>)],sigma)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">invF</span>(U[(N<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],sigma)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>AX <span class="ot">&lt;-</span> <span class="fu">invF</span>(<span class="dv">1</span><span class="sc">-</span>U[<span class="dv">1</span><span class="sc">:</span>(N<span class="sc">/</span><span class="dv">2</span>)],sigma)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>svar1 <span class="ot">&lt;-</span> <span class="fu">sd</span>((X1<span class="sc">+</span>X2)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> N <span class="sc">/</span> (N<span class="dv">-1</span>)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>svar2 <span class="ot">&lt;-</span> <span class="fu">sd</span>((X1<span class="sc">+</span>AX)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> N <span class="sc">/</span>(N<span class="dv">-1</span>)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;The variance reducts &quot;</span>,(<span class="dv">1</span><span class="sc">-</span>svar2<span class="sc">/</span>svar1)<span class="sc">*</span><span class="dv">100</span>,<span class="st">&quot;%.&quot;</span>))</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><span class="math inline">\(g(x)\)</span> is defined on <span class="math inline">\((1,\infty)\)</span>. We choose two density
functions as our importance functions.</li>
</ol>
<p>First, we select the half-normal distribution on <span class="math inline">\((1,\infty)\)</span>: <span class="math display">\[
f_1(x)=\sqrt{\frac{2}{\pi}}e^{-\frac{(x-1)^2}{2}},x&gt;1.
\]</span></p>
<p>Then, we chose the exponential distribution on <span class="math inline">\((1,\infty)\)</span>: <span class="math display">\[
f_2(x)=\lambda e^{-\lambda(x-1)},x&gt;1.
\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  result <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>}</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(x<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>}</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,lambda){</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  result <span class="ot">&lt;-</span> lambda <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>(x<span class="dv">-1</span>))</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">g</span>(X)<span class="sc">/</span><span class="fu">f1</span>(X))</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="do">##parameter of the exponential distribution</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N,lambda)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">g</span>(Y)<span class="sc">/</span><span class="fu">f2</span>(Y,lambda))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">importance function</th>
<th align="center"><span class="math inline">\(f_1(x)\)</span></th>
<th align="center"><span class="math inline">\(f_2(x)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(\int_1^{\infty}
g(x)dx\)</span></td>
<td align="center">0.4003865</td>
<td align="center">0.4006047</td>
</tr>
</tbody>
</table>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>The quick sort function is as follows:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}<span class="co">#??????</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>}</span></code></pre></div>
<p>We set <span class="math inline">\(n=10^4,2\times 10^4,4\times
10^4,6\times 10^4,8\times 10^4\)</span>, and calculate computation
time.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>time1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(all)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>time2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(all)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>time4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(all)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>time6 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(all)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>time8 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(all)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>all){</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  test1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fl">1e4</span>)</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  test2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span><span class="fl">1e4</span>))</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  test4 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">4</span><span class="sc">*</span><span class="fl">1e4</span>))</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>  test6 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">6</span><span class="sc">*</span><span class="fl">1e4</span>))</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>  test8 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">8</span><span class="sc">*</span><span class="fl">1e4</span>))</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>  time1[i] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test1))[<span class="dv">1</span>]</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  time2[i] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test2))[<span class="dv">1</span>]</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  time4[i] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test4))[<span class="dv">1</span>]</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>  time6[i] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test6))[<span class="dv">1</span>]</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>  time8[i] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test8))[<span class="dv">1</span>]</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>}</span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(time1),<span class="fu">mean</span>(time2),<span class="fu">mean</span>(time4),<span class="fu">mean</span>(time6),<span class="fu">mean</span>(time8))</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>time</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">n</th>
<th align="center"><span class="math inline">\(1e4\)</span></th>
<th align="center"><span class="math inline">\(2 \times
1e4\)</span></th>
<th align="center"><span class="math inline">\(4 \times
1e4\)</span></th>
<th align="center"><span class="math inline">\(6 \times
1e4\)</span></th>
<th align="center"><span class="math inline">\(8 \times
1e4\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">time</td>
<td align="center">0.0133</td>
<td align="center">0.0236</td>
<td align="center">0.0639</td>
<td align="center">0.0848</td>
<td align="center">0.1195</td>
</tr>
</tbody>
</table>
<p>The regression results between <span class="math inline">\(a_n\)</span> and <span class="math inline">\(t_n
:= n \log(n)\)</span> are as follows:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>)<span class="sc">*</span><span class="fl">1e4</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>true <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">log</span>(n)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="fu">lm</span>(time<span class="sc">~</span>true)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="fu">plot</span>(true,time)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">coef</span>(<span class="fu">lm</span>(time<span class="sc">~</span>true))[<span class="dv">1</span>],<span class="fu">coef</span>(<span class="fu">lm</span>(time<span class="sc">~</span>true))[<span class="dv">2</span>],<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="homework-2024.09.30" class="section level2">
<h2>Homework-2024.09.30</h2>
<div id="question-3" class="section level3">
<h3>Question</h3>
<ol style="list-style-type: decimal">
<li><p>Estimate the <span class="math inline">\(0.025,0.05,0.95,\)</span> and <span class="math inline">\(0.975\)</span> quantiles of the skewness <span class="math inline">\(\sqrt{b_1}\)</span> under normality by a Monte
Carlo experiment. Compute the standard error of the estimates from <span class="math inline">\((2.14)\)</span> using the normal approximation for
the density (with exact variance formula). Compare the estimated
quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_1} \approx
\mathcal{N}(0,6/n)\)</span>.</p></li>
<li><p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(\rho\)</span>, Spearman’s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall’s
coefficient <span class="math inline">\(\tau\)</span>, are implemented
in <span class="math inline">\(\textbf{cor.test}\)</span>. Show
(empirically) that the nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative(a bivariate distribution (X,Y) such that X
and Y are dependent) such that at least one of the nonparametric tests
have bette emoirical power than the correlation test against this
alternative.</p></li>
<li><p>If we obtain the powers for two methods under a particular
simulation setting with <span class="math inline">\(10,000\)</span>
experiments: say, 0.651 for one method and 0.676 for another method. We
want to know if the powers are different at <span class="math inline">\(0.05\)</span> level.</p></li>
</ol>
<p>(a). What is the corresponding hypothesis test problem?</p>
<p>(b). What test should we use? Z-test,two-sample t-test,paired-t test
or McNemar test? Why?</p>
<p>(c). Please provide the least necessary information for hypothesis
testing.</p>
</div>
<div id="answer-3" class="section level3">
<h3>Answer</h3>
<ol style="list-style-type: decimal">
<li>We first set the sample size <span class="math inline">\(n =
1000\)</span> and repeat the experiment <span class="math inline">\(N\)</span> times to obtain <span class="math inline">\(N\)</span> estimates of skewness. For the
skewness, we use the method of moments for estimation. <span class="math display">\[
\sqrt{b_1}=\frac{\mu_3}{\mu_2^{3/2}},\qquad
\mu_k=\mathbb{E}[X-\mathbb{E}(X)]^k.
\]</span></li>
</ol>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>skew <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  <span class="fu">set.seed</span>(i)</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((X<span class="sc">-</span><span class="fu">mean</span>(X))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((X<span class="sc">-</span><span class="fu">mean</span>(X))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>  skew[i] <span class="ot">&lt;-</span> m3<span class="sc">/</span>(m2<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>}</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="fu">hist</span>(skew,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.3</span>),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="at">breaks =</span> <span class="dv">12</span>)</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.01</span>)</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="dv">1</span><span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">6</span><span class="sc">/</span>n))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="dv">6</span><span class="sc">/</span>n)),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">quantile</span>(skew,<span class="at">probs=</span>q)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="fu">qnorm</span>(q,<span class="dv">0</span>,<span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n))</span></code></pre></div>
<p>According to the equation<span class="math inline">\((2.14)\)</span>,
the variance of the <span class="math inline">\(q\)</span> sample
quantile is <span class="math display">\[
Var(\hat{x}_q)=\frac{q(1-q)}{nf(x_q)^2},
\]</span> where <span class="math inline">\(f\)</span> is the density of
the sampled distribution.</p>
<p>Since the distribution <span class="math inline">\(f\)</span> is
unknown, we use the normal distribution to approximate the estimate of
<span class="math inline">\(f(x_q)\)</span>. Therefore, we first need to
estimate the sample mean and variance of the skewness data.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>smean <span class="ot">&lt;-</span> <span class="fu">mean</span>(skew)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>svar <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(N<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sum</span>((skew<span class="sc">-</span><span class="fu">mean</span>(skew))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>fq <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(<span class="fu">quantile</span>(skew,<span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)),<span class="at">mean =</span> smean,<span class="at">sd=</span><span class="fu">sqrt</span>(svar))</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>varq <span class="ot">&lt;-</span> q<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>q)<span class="sc">/</span>(N<span class="sc">*</span>fq<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>varq</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">quantile</th>
<th align="center">0.025</th>
<th align="center">0.05</th>
<th align="center">0.95</th>
<th align="center">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Skewness quantile</td>
<td align="center">-0.1515948</td>
<td align="center">-0.1272963</td>
<td align="center">0.1286182</td>
<td align="center">0.1516004</td>
</tr>
<tr class="even">
<td align="center">Approximate normal quantile</td>
<td align="center">-0.1518182</td>
<td align="center">-0.1274098</td>
<td align="center">0.1274098</td>
<td align="center">0.1518182</td>
</tr>
<tr class="odd">
<td align="center">Estimate variance</td>
<td align="center">4.010600e-05</td>
<td align="center">2.567798e-05</td>
<td align="center">2.817547e-05</td>
<td align="center">4.191878e-05</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: decimal">
<li>We first generate a random variable following a bivariate normal
distribution, considering the case where the alternative hypothesis is
true.</li>
</ol>
<p>Clear memory before calling the function.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(sigma1<span class="sc">^</span><span class="dv">2</span>,cor<span class="sc">*</span>sigma1<span class="sc">*</span>sigma2,cor<span class="sc">*</span>sigma1<span class="sc">*</span>sigma2,sigma2<span class="sc">^</span><span class="dv">2</span>),<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>reject1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>reject2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>reject3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>  <span class="fu">set.seed</span>(i)</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(n,<span class="at">mean =</span> mean,<span class="at">sigma =</span> sigma) <span class="do">##data generation</span></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>],data[,<span class="dv">2</span>],<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,<span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>))<span class="sc">$</span>p.value</span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>],data[,<span class="dv">2</span>],<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,<span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;spearman&quot;</span>))<span class="sc">$</span>p.value</span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>],data[,<span class="dv">2</span>],<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,<span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;kendall&quot;</span>))<span class="sc">$</span>p.value</span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a>  reject1[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(p1<span class="sc">&lt;</span>alpha) <span class="do">##rejection</span></span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a>  reject2[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(p2<span class="sc">&lt;</span>alpha)</span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a>  reject3[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(p3<span class="sc">&lt;</span>alpha)</span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a>}</span></code></pre></div>
<p>The power of the three tests is as follows:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">sum</span>(reject1)<span class="sc">/</span>N <span class="do">##power</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="fu">sum</span>(reject2)<span class="sc">/</span>N</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="fu">sum</span>(reject3)<span class="sc">/</span>N</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">test</th>
<th align="center">Pearson</th>
<th align="center">Spearman</th>
<th align="center">Kendall</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">power</td>
<td align="center">0.873</td>
<td align="center">0.849</td>
<td align="center">0.85</td>
</tr>
</tbody>
</table>
<p>It can be seen that the power of the Pearson test is higher than that
of the Spearman test and the Kendall test when the samples follow the
bivariate normal distribution.</p>
<p>Consider the bivariate exponential distribution, implemented through
a custom function, while also considering the case where the alternative
hypothesis is true.</p>
<p>Clear memory before calling the function.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>Custom function to generate bivariate exponential distribution。</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>generate_bivariate_exponential <span class="ot">&lt;-</span> <span class="cf">function</span>(n, lambda1, lambda2, correlation) {</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  u1 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> lambda1)  <span class="co"># first variable</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  u2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> lambda2)  <span class="co"># second variable</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  </span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  <span class="co"># adjust the second variable through correlation</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  v <span class="ot">&lt;-</span> correlation <span class="sc">*</span> u1 <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> correlation<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> u2</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  </span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">X =</span> u1, <span class="at">Y =</span> v))</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>lambda1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>lambda2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>reject1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>reject2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>reject3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  <span class="fu">set.seed</span>(i)</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">generate_bivariate_exponential</span>(n, lambda1, lambda2, correlation) <span class="co">#data generation</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data<span class="sc">$</span>X,data<span class="sc">$</span>Y,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,<span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>))<span class="sc">$</span>p.value</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data<span class="sc">$</span>X,data<span class="sc">$</span>Y,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,<span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;spearman&quot;</span>))<span class="sc">$</span>p.value</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data<span class="sc">$</span>X,data<span class="sc">$</span>Y,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,<span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;kendall&quot;</span>))<span class="sc">$</span>p.value</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>  reject1[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(p1<span class="sc">&lt;</span>alpha) <span class="co">#rejection</span></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>  reject2[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(p2<span class="sc">&lt;</span>alpha)</span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>  reject3[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(p3<span class="sc">&lt;</span>alpha)</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>}</span></code></pre></div>
<p>The power of the three tests is as follows:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">sum</span>(reject1)<span class="sc">/</span>N <span class="do">##power</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="fu">sum</span>(reject2)<span class="sc">/</span>N</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="fu">sum</span>(reject3)<span class="sc">/</span>N</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">test</th>
<th align="center">Pearson</th>
<th align="center">Spearman</th>
<th align="center">Kendall</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">power</td>
<td align="center">0.912</td>
<td align="center">0.988</td>
<td align="center">0.989</td>
</tr>
</tbody>
</table>
<p>It can be seen that the power of the Pearson test is lower than that
of the Spearman test and the Kendall test when the samples follow the
bivariate exponential distribution.</p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>(a). Based on the problem statement, we aim to test whether the power
of the two methods differs at the significance level of <span class="math inline">\(0.05\)</span>. Therefore, the corresponding
hypothesis testing problem is:</p>
<p><span class="math display">\[
H_0: \text{There is no difference in the power of the two test methods.}
\]</span> <span class="math display">\[
H_1: \text{There is a difference in the power of the two test methods.}
\]</span></p>
<p>Let <span class="math inline">\(p_1\)</span> represent the power of
Method 1 and <span class="math inline">\(p_2\)</span> represent the
power of Method 2. Then, the hypothesis testing problem is: <span class="math display">\[
H_0:p_1=p_2. \qquad H_1:p_1\neq p_2.
\]</span></p>
<p>(b).</p>
<p><span class="math inline">\(\textbf{The z-test}\)</span> is generally
used to compare the differences in sample means for large samples, and
it uses the theory of the standard normal distribution to infer the
probability of such differences occurring.</p>
<p><span class="math inline">\(\textbf{The two-sample t-test}\)</span>
is commonly used to compare whether the means of two independent samples
are significantly different.</p>
<p><span class="math inline">\(\textbf{The paired t-test}\)</span>
compares the means of two related samples to determine whether there is
a significant difference between the two groups.</p>
<p><span class="math inline">\(\textbf{The McNemar test}\)</span> is a
paired test for <span class="math inline">\(2 \times 2\)</span>
contingency tables, using each subject as their own control to test
whether there are significant changes between two groups.</p>
<p>Since we aim to compare the power of two test methods across <span class="math inline">\(10,000\)</span> experiments based on the samples
from each experiment, it is clear that the power of the tests does not
asymptotically follow a normal distribution in large samples. Moreover,
the results of the two test methods from each experiment are not
independent. Additionally, we are not dealing with a <span class="math inline">\(2 \times 2\)</span> paired data table. Therefore,
using <span class="math inline">\(\textbf{the paired t-test}\)</span> is
the most appropriate choice.</p>
<p>(c). For the hypothesis testing problem, the necessary information we
need to know includes:</p>
<p>According to the problem, the significance level is <span class="math inline">\(\alpha = 0.05\)</span>, the sample size is <span class="math inline">\(n = 10,000\)</span>, and the powers under the two
tests are <span class="math inline">\(p_1 = 0.651\)</span> and <span class="math inline">\(p_2 = 0.676\)</span>.</p>
<p>Let the results of each experimental sample under the two test
methods be <span class="math inline">\(A_i, B_i \in \{0, 1\}\)</span>.
Then, we have <span class="math inline">\(p_1 = \frac{1}{n} \sum_{i=1}^n
A_i\)</span> and <span class="math inline">\(p_2 = \frac{1}{n}
\sum_{i=1}^n B_i\)</span>. The variance of the sample differences is
given by <span class="math inline">\(s^2 = \frac{1}{n-1} \sum_{i=1}^n
(A_i - B_i - (0.651 - 0.676))^2\)</span>. The maximum variance is <span class="math inline">\(s^2_{max} = 1.05073\)</span> and the minimum
variance is <span class="math inline">\(s^2_{min} = 0.00300\)</span>.
Therefore, the minimum value of the test statistic <span class="math inline">\(t\)</span> is calculated as follows: <span class="math display">\[
t = \frac{0.025}{\sqrt{1.05073/10000}} \approx 2.44 &gt; t_{\alpha/2} =
1.96.
\]</span></p>
<p>Thus, we reject the null hypothesis, concluding that there is a
significant difference in the powers of the two tests.</p>
</div>
</div>
<div id="homework-2024.10.14" class="section level2">
<h2>Homework-2024.10.14</h2>
<div id="question-4" class="section level3">
<h3>Question</h3>
<ol style="list-style-type: decimal">
<li><p>Of <span class="math inline">\(N=1000\)</span> hypotheses, <span class="math inline">\(950\)</span> are null and <span class="math inline">\(50\)</span> are alternative. The p-value under any
null hypothesis is uniformly distributed(use runif), and the p-value
under any alternative hypothesis follows the beta distribution with
parameter <span class="math inline">\(0.1\)</span> and <span class="math inline">\(1\)</span> (use rbeta). Obtain Bonferroni adjusted
p-values and B-H adjusted p-values. Calculate FWER, FDR, and TPR under
nominal level <span class="math inline">\(\alpha = 0.1\)</span> for each
of the two adjustment methods based on <span class="math inline">\(m =
10000\)</span> simulation replicates. You should output the <span class="math inline">\(6\)</span> numbers (3) to a <span class="math inline">\(3 \times 2\)</span> table (column names:
Bonferroni correction, B-H correction; row names: FWER, FDR, TPR).
Comment the results.</p></li>
<li><p>Refer to the air-conditioning data set aircondit provided in the
boot package. The <span class="math inline">\(12\)</span> observations
are the times in hours between failures of airconditioning equipment
[63, Example 1.1]: <span class="math display">\[
3, 5, 7, 18, 43, 85, 91, 98, 100, 130, 230, 487.
\]</span> Assume that the times between failures follow an exponential
model Exp(<span class="math inline">\(\lambda\)</span>). Obtain the MLE
of the hazard rate λ and use bootstrap to estimate the bias and standard
error of the estimate.</p></li>
<li><p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals
for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p></li>
<li><p>Suppose the population has the exponential distribution with rate
<span class="math inline">\(\lambda\)</span>, then the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat{\lambda}=1/ \bar{X}\)</span>, where <span class="math inline">\(\bar{X}\)</span> is the sample mean. It can be
derived that the expectation of <span class="math inline">\(\hat{\lambda}\)</span> is <span class="math inline">\(\lambda n /(n-1)\)</span>, so that the estimation
bias is <span class="math inline">\(\lambda /(n − 1)\)</span>. The
standard error <span class="math inline">\(\hat{\lambda}\)</span> is
<span class="math inline">\(\lambda n / [(n-1)\sqrt{n-2}]\)</span>.
Conduct a simulation study to verify the performance of the bootstrap
method.</p></li>
</ol>
</div>
<div id="solution" class="section level3">
<h3>Solution</h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p><span class="math display">\[
\text{FWER} = P(\text{at least one } H_0 \text{ is incorrectly
rejected})
\]</span></p>
<p><span class="math display">\[
\text{FDR} = \frac{\text{Number of False Positives}}{\text{Total Number
of Rejected Hypotheses}}
\]</span></p>
<p><span class="math display">\[
\text{TPR} = \frac{\text{Number of True Positives}}{\text{Total Number
of Alternative Hypotheses}}
\]</span></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>n_null <span class="ot">&lt;-</span> <span class="dv">950</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>n_alt <span class="ot">&lt;-</span> N <span class="sc">-</span> n_null</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni correction&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>)</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="fu">rownames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>  </span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>  <span class="fu">set.seed</span>(i)</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a>  p_null <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_null,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>  p_alt <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n_alt, <span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(p_null, p_alt)</span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>  </span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a>  bonferroni_p <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a>  bh_p <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a>  </span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a>  bonferroni_rejects <span class="ot">&lt;-</span> <span class="fu">which</span>(bonferroni_p <span class="sc">&lt;</span> alpha)</span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a>  fwer_bon <span class="ot">&lt;-</span> <span class="fu">sum</span>(bonferroni_rejects <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>n_null) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a>  fdr_bon <span class="ot">&lt;-</span> <span class="fu">sum</span>(bonferroni_rejects <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>n_null) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">length</span>(bonferroni_rejects), <span class="dv">1</span>)</span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a>  tpr_bon <span class="ot">&lt;-</span> <span class="fu">sum</span>(bonferroni_rejects <span class="sc">%in%</span> (n_null <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N) <span class="sc">/</span> n_alt</span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a>  </span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a>  bh_rejects <span class="ot">&lt;-</span> <span class="fu">which</span>(bh_p <span class="sc">&lt;</span> alpha)</span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a>  fwer_bh <span class="ot">&lt;-</span> <span class="fu">sum</span>(bh_rejects <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>n_null) <span class="sc">&gt;</span> <span class="dv">0</span>  <span class="co"># If at least one null hypothesis is incorrectly rejected, it is recorded as a false positive event.</span></span>
<span id="cb33-28"><a href="#cb33-28" tabindex="-1"></a>  fdr_bh <span class="ot">&lt;-</span> <span class="fu">sum</span>(bh_rejects <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>n_null) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">length</span>(bh_rejects), <span class="dv">1</span>) <span class="co"># Calculate how many of the rejected hypotheses are null hypotheses.</span></span>
<span id="cb33-29"><a href="#cb33-29" tabindex="-1"></a>  tpr_bh <span class="ot">&lt;-</span> <span class="fu">sum</span>(bh_rejects <span class="sc">%in%</span> (n_null <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N) <span class="sc">/</span> n_alt <span class="co"># Calculate the number of correctly rejected alternative hypotheses divided by the total number of true alternative hypotheses.</span></span>
<span id="cb33-30"><a href="#cb33-30" tabindex="-1"></a>  </span>
<span id="cb33-31"><a href="#cb33-31" tabindex="-1"></a>  results[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> results[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> fwer_bon</span>
<span id="cb33-32"><a href="#cb33-32" tabindex="-1"></a>  results[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> results[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">+</span> fdr_bon</span>
<span id="cb33-33"><a href="#cb33-33" tabindex="-1"></a>  results[<span class="dv">3</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> results[<span class="dv">3</span>, <span class="dv">1</span>] <span class="sc">+</span> tpr_bon</span>
<span id="cb33-34"><a href="#cb33-34" tabindex="-1"></a>  </span>
<span id="cb33-35"><a href="#cb33-35" tabindex="-1"></a>  results[<span class="dv">1</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> results[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">+</span> fwer_bh</span>
<span id="cb33-36"><a href="#cb33-36" tabindex="-1"></a>  results[<span class="dv">2</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> results[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">+</span> fdr_bh</span>
<span id="cb33-37"><a href="#cb33-37" tabindex="-1"></a>  results[<span class="dv">3</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> results[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> tpr_bh</span>
<span id="cb33-38"><a href="#cb33-38" tabindex="-1"></a>}</span>
<span id="cb33-39"><a href="#cb33-39" tabindex="-1"></a></span>
<span id="cb33-40"><a href="#cb33-40" tabindex="-1"></a>results <span class="ot">&lt;-</span> results <span class="sc">/</span> m</span>
<span id="cb33-41"><a href="#cb33-41" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(results, <span class="dv">4</span>))</span></code></pre></div>
<p>It can be seen that the Bonferroni correction is very effective in
controlling Type I errors, while the B-H correction performs poorly. For
FDR, the Bonferroni correction is more conservative, which may lead to
many true alternative hypotheses not being recognized, while the FDR
value of the B-H correction is relatively high. Regarding TPR, the value
obtained from the Bonferroni correction is low, indicating insufficient
capability in identifying true alternative hypotheses, whereas the B-H
correction shows stronger ability in recognizing true alternative
hypotheses.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>From Exercise 4, we know that the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat{\lambda} = 1/\bar{X}\)</span>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>aircondit_times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(aircondit_times)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> sample_mean</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>lambda_mle_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(sample_data))</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>}</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> aircondit_times, <span class="at">statistic =</span> lambda_mle_boot, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a><span class="fu">print</span>(boot_results)</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>lambda_bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_results<span class="sc">$</span>t) <span class="sc">-</span> lambda_mle</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>lambda_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_results<span class="sc">$</span>t)</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;MLE of lambda:&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;Bias estimate:&quot;</span>, lambda_bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;Standard error estimate:&quot;</span>, lambda_se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>mu_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(sample_data))  </span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>}</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> aircondit_times, <span class="at">statistic =</span> mu_boot, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>normal_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">&quot;norm&quot;</span>)</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>basic_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>percentile_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>bca_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;Normal 95% CI:&quot;</span>, normal_ci<span class="sc">$</span>normal[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;Basic 95% CI:&quot;</span>, basic_ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;Percentile 95% CI:&quot;</span>, percentile_ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;BCa 95% CI:&quot;</span>, bca_ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>The normal confidence interval assumes that the distribution of the
sample mean is normal and calculates the confidence interval based on
the standard error of the sample mean, making it suitable for larger
sample sizes.</p>
<p>The basic confidence interval is directly calculated based on the
mean and standard error of the bootstrap samples, making it applicable
when the distribution of the original data is uncertain.</p>
<p>The percentile confidence interval directly determines the confidence
interval by taking the percentiles of the bootstrap samples.</p>
<p>The BCa confidence interval applies bias correction and acceleration
to the basic confidence interval, enhancing its accuracy.</p>
<p>In this case, the widths of the four confidence intervals do not
differ significantly.</p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>lambda_true <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sample_size =</span> <span class="fu">integer</span>(),</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>                      <span class="at">mean_bootstrap_bias =</span> <span class="fu">numeric</span>(),</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>                      <span class="at">bootstrap_se =</span> <span class="fu">numeric</span>(),</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>                      <span class="at">theoretical_bias =</span> <span class="fu">numeric</span>(),</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>                      <span class="at">theoretical_se =</span> <span class="fu">numeric</span>())</span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> sizes) {</span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>  mean_bias <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>  bootstrap_se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>  </span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>    <span class="fu">set.seed</span>(i)</span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>    sample_data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> lambda_true)</span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>    boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> sample_data, <span class="at">statistic =</span> lambda_mle_boot, <span class="at">R =</span> B)</span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>    mean_bias[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_results<span class="sc">$</span>t) <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(sample_data))</span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a>    bootstrap_se[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_results<span class="sc">$</span>t)</span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a>  }</span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a>  </span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a>  mean_bootstrap_bias_avg <span class="ot">&lt;-</span> <span class="fu">mean</span>(mean_bias)</span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a>  bootstrap_se_avg <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_se)</span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a>  </span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a>  theoretical_bias <span class="ot">&lt;-</span> lambda_true <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a>  theoretical_se <span class="ot">&lt;-</span> (lambda_true <span class="sc">*</span> n) <span class="sc">/</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(n <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a>  </span>
<span id="cb36-30"><a href="#cb36-30" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results,</span>
<span id="cb36-31"><a href="#cb36-31" tabindex="-1"></a>                    <span class="fu">data.frame</span>(<span class="at">sample_size =</span> n,</span>
<span id="cb36-32"><a href="#cb36-32" tabindex="-1"></a>                               <span class="at">mean_bootstrap_bias =</span> mean_bootstrap_bias_avg,</span>
<span id="cb36-33"><a href="#cb36-33" tabindex="-1"></a>                               <span class="at">bootstrap_se =</span> bootstrap_se_avg,</span>
<span id="cb36-34"><a href="#cb36-34" tabindex="-1"></a>                               <span class="at">theoretical_bias =</span> theoretical_bias,</span>
<span id="cb36-35"><a href="#cb36-35" tabindex="-1"></a>                               <span class="at">theoretical_se =</span> theoretical_se))</span>
<span id="cb36-36"><a href="#cb36-36" tabindex="-1"></a>}</span>
<span id="cb36-37"><a href="#cb36-37" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<p>It can be seen that as the sample size increases, the bootstrap bias
and standard deviation become closer to the theoretical values.</p>
</div>
</div>
<div id="homework-2024.10.21" class="section level2">
<h2>Homework-2024.10.21</h2>
<div id="question-5" class="section level3">
<h3>Question</h3>
<ol style="list-style-type: decimal">
<li><p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>,</p></li>
<li><p>In Example 7.18, leave-one-out(<span class="math inline">\(n\)</span>-fold) cross validation was used to
select the best fitting model. Repeat the analysis replacing the Log-Log
model with a cubic polynomial model. Which of the four models is
selected by the cross validation procedure? Which model is selected
according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p></li>
<li><p>Implement the two-sample Cramer-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p></li>
<li><p>Implement the bivariate Spearman rank correlation test for
independence[255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function cor with method =
“spearman”. Compare the achieved significance level of the permutation
test with the <span class="math inline">\(p\)</span>-value reported by
cor.test on the same samples.</p></li>
</ol>
</div>
<div id="solution-1" class="section level3">
<h3>Solution</h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>The Jackknife method is used to estimate the bias and standard error
of a statistic. Each observation can be removed once to calculate the
<span class="math inline">\(\hat{\lambda}\)</span> value for each
sample, which allows the calculation of <span class="math inline">\(\hat{\theta}\)</span> values, and then the overall
bias and standard error can be computed.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>scor</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>cov_scor <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cov_scor)<span class="sc">$</span>values</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> lambda [<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda )</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>theta_jackknife <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>  cov_jack <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor[<span class="sc">-</span>i, ])</span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>  lambda_jack <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cov_jack)<span class="sc">$</span>values</span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>  theta_jackknife[i] <span class="ot">&lt;-</span> lambda_jack[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda_jack)</span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a>}</span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a>bias_jack <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta_jackknife) <span class="sc">-</span> theta_hat)</span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a>se_jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">mean</span>((theta_jackknife <span class="sc">-</span> theta_hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta_hat,<span class="at">bias.jack=</span>bias_jack,</span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a><span class="at">se.jack=</span>se_jack),<span class="dv">5</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Cubic: <span class="math display">\[
Y=\beta_0 + \beta_1 X + \beta_2 X^2 + \beta_3 X^3 + \epsilon.
\]</span></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, .<span class="dv">1</span>)</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>L1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical)</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a><span class="fu">plot</span>(chemical, magnetic, <span class="at">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>yhat1 <span class="ot">&lt;-</span> L1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a><span class="fu">lines</span>(a, yhat1, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>L2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a><span class="fu">plot</span>(chemical, magnetic, <span class="at">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>yhat2 <span class="ot">&lt;-</span> L2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a <span class="sc">+</span> L2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a><span class="fu">lines</span>(a, yhat2, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a>L3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(magnetic) <span class="sc">~</span> chemical)</span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a><span class="fu">plot</span>(chemical, magnetic, <span class="at">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a>logyhat3 <span class="ot">&lt;-</span> L3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a</span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a>yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a><span class="fu">lines</span>(a, yhat3, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a>L4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a><span class="fu">plot</span>(chemical, magnetic, <span class="at">main=</span><span class="st">&quot;Cubic&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a>yhat4 <span class="ot">&lt;-</span> L4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a <span class="sc">+</span> L4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> L4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a><span class="fu">lines</span>(a, yhat4, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>  e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>  J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>  e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>  e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a>  e4[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat4</span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a>}</span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p>By comparing the prediction errors of each model, we can see that the
cross-validation procedure still selects model 2.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>L2</span></code></pre></div>
<p><span class="math display">\[
\text{adjusted } R^2 = 1 - (1 - R^2) \frac{n - 1}{n - p - 1}
\]</span></p>
<p>Here, <span class="math inline">\(n\)</span> is the sample size, and
<span class="math inline">\(p\)</span> is the number of parameters in
the model.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>R2_1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(J1)<span class="sc">$</span>r.squared</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>adj_R2_1 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> R2_1) <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (n <span class="sc">-</span> p1 <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>R2_2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(J2)<span class="sc">$</span>r.squared</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>adj_R2_2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> R2_2) <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (n <span class="sc">-</span> p2 <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>R2_3 <span class="ot">&lt;-</span> <span class="fu">summary</span>(J3)<span class="sc">$</span>r.squared</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>adj_R2_3 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> R2_3) <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (n <span class="sc">-</span> p3 <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>R2_4 <span class="ot">&lt;-</span> <span class="fu">summary</span>(J4)<span class="sc">$</span>r.squared</span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>adj_R2_4 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> R2_4) <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (n <span class="sc">-</span> p4 <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a><span class="fu">c</span>(adj_R2_1,adj_R2_2,adj_R2_3,adj_R2_4)</span></code></pre></div>
<p>According to the maximum adjusted <span class="math inline">\(R^2\)</span>, model 4 is selected.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>L4</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>The Cramer-von Mises test is used to compare whether two
distributions are the same. This is implemented through a permutation
test, which randomly samples from the combined samples to obtain
multiple sets of data and computes the Cramer-von Mises statistic for
each group, comparing it to the observed statistic to estimate the
significance level.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>cvm_statistic <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sort</span>(x), <span class="fu">sort</span>(y))</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>  ecdf_x <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(combined <span class="sc">%in%</span> x) <span class="sc">/</span> n</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>  ecdf_y <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(combined <span class="sc">%in%</span> y) <span class="sc">/</span> m</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="fu">sum</span>((ecdf_x <span class="sc">-</span> ecdf_y)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> (n <span class="sc">*</span> m) <span class="sc">/</span> (n <span class="sc">+</span> m)<span class="sc">^</span><span class="dv">2</span>  <span class="co"># 归一化</span></span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>  <span class="fu">return</span>(D)</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>}</span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a>D0 <span class="ot">&lt;-</span> <span class="fu">cvm_statistic</span>(x,y)</span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)</span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a>  <span class="fu">set.seed</span>(i)</span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a>  permuted_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">length</span>(z))</span>
<span id="cb43-24"><a href="#cb43-24" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[permuted_indices[<span class="dv">1</span><span class="sc">:</span>n1]]</span>
<span id="cb43-25"><a href="#cb43-25" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> z[permuted_indices[(n1 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n1 <span class="sc">+</span> n2)]]</span>
<span id="cb43-26"><a href="#cb43-26" tabindex="-1"></a>  D[i] <span class="ot">&lt;-</span> <span class="fu">cvm_statistic</span>(x1, x2)</span>
<span id="cb43-27"><a href="#cb43-27" tabindex="-1"></a>}</span>
<span id="cb43-28"><a href="#cb43-28" tabindex="-1"></a></span>
<span id="cb43-29"><a href="#cb43-29" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(D0, D) <span class="sc">&gt;=</span> D0)</span>
<span id="cb43-30"><a href="#cb43-30" tabindex="-1"></a>p_value</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>We generate two samples <span class="math inline">\((X,Y)\)</span>
that follow <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>: <span class="math display">\[
X_{H_0} \sim \mathcal{N}(0,1) \quad Y_{H_0} \sim \mathcal{N}(0,1),
\]</span> <span class="math display">\[
X_{H_1} \sim \mathcal{N}(0,1) \quad Y_{H_1} \sim X_{H_1} +
\mathcal{N}(0,0.5^2).
\]</span></p>
<p>The function <code>spearman_permutation_test</code> defined here
computes the Spearman rank correlation coefficient and the p-value of
the permutation test.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>X_h0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>Y_h0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>X_h1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>Y_h1 <span class="ot">&lt;-</span> X_h1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.5</span>) </span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>spearman_permutation_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R =</span> <span class="dv">999</span>) {</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>  original_correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>  perm_correlations <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>    <span class="fu">set.seed</span>(i)</span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>    perm_y <span class="ot">&lt;-</span> <span class="fu">sample</span>(y)</span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a>    perm_correlations[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, perm_y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a>  }</span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(perm_correlations) <span class="sc">&gt;=</span> <span class="fu">abs</span>(original_correlation))</span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">correlation =</span> original_correlation, <span class="at">p_value =</span> p_value))</span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>}</span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a>result_h0 <span class="ot">&lt;-</span> <span class="fu">spearman_permutation_test</span>(X_h0, Y_h0)</span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a>result_h1 <span class="ot">&lt;-</span> <span class="fu">spearman_permutation_test</span>(X_h1, Y_h1)</span>
<span id="cb44-22"><a href="#cb44-22" tabindex="-1"></a>cor_test_h0 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X_h0, Y_h0, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb44-23"><a href="#cb44-23" tabindex="-1"></a>cor_test_h1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X_h1, Y_h1, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb44-24"><a href="#cb44-24" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Under H0:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb44-26"><a href="#cb44-26" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Spearman correlation:&quot;</span>, result_h0<span class="sc">$</span>correlation, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb44-27"><a href="#cb44-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;permutation p-value:&quot;</span>, result_h0<span class="sc">$</span>p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb44-28"><a href="#cb44-28" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;cor.test p-value:&quot;</span>, cor_test_h0<span class="sc">$</span>p.value, <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb44-29"><a href="#cb44-29" tabindex="-1"></a></span>
<span id="cb44-30"><a href="#cb44-30" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Under H1:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb44-31"><a href="#cb44-31" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Spearman correlation:&quot;</span>, result_h1<span class="sc">$</span>correlation, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb44-32"><a href="#cb44-32" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;permutation p-value:&quot;</span>, result_h1<span class="sc">$</span>p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb44-33"><a href="#cb44-33" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;cor.test p-value:&quot;</span>, cor_test_h1<span class="sc">$</span>p.value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="homework-2024.10.28" class="section level2">
<h2>Homework-2024.10.28</h2>
<div id="question-6" class="section level3">
<h3>Question</h3>
<ol style="list-style-type: decimal">
<li>Use the Metropolis-Hastings sampler to generate random variables
from a standard Cauchy distribution. Discard the first 1000 of the
chain, and compare the deciles of the generated observations with the
deciles of the standard Cauchy distribution (see qcauchy or qt with
df=1). Recall that a Cauchy(<span class="math inline">\(\theta,\eta\)</span>) distribution has density
function <span class="math display">\[
f(x)= \frac{ 1 }{ \theta \pi (1+[(x-\eta)/ \theta]^2) }, \quad -\infty
&lt; x &lt; \infty,\theta&gt;0.
\]</span></li>
</ol>
<p>The standard Cauchy has the Cauchy(<span class="math inline">\(\theta=1,\eta=0\)</span>)density. (Note that the
standard Cauchy density is equal to the Student <span class="math inline">\(t\)</span> density with one degree of
freedom.)</p>
<ol start="2" style="list-style-type: decimal">
<li><p>This example appears in [40]. Consider the bivariate density
<span class="math display">\[
f(x,y) \propto \binom{n}{x} y^{x+a-1} (1-y)^{n-x+b-1},\quad
x=0,1,\dots,n, \, 0 \leq y \leq1.
\]</span> It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a\)</span>,<span class="math inline">\(b\)</span>,<span class="math inline">\(n\)</span>,
the conditional distributions are Binomial(<span class="math inline">\(n, y\)</span>) and Beta(<span class="math inline">\(x + a, n − x + b\)</span>). Use the Gibbs sampler
to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>.</p></li>
<li><p>For each of the above exercise, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</p></li>
<li><p>Algorithm(continuous situation)</p></li>
</ol>
</div>
<div id="solution-2" class="section level3">
<h3>Solution</h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>metropolis_hastings <span class="ot">&lt;-</span> <span class="cf">function</span>(num_samples) {</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>  current <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>    proposed <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> current) </span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>    acceptance_ratio <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(proposed) <span class="sc">/</span> <span class="fu">dcauchy</span>(current)</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> acceptance_ratio) {</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>      current <span class="ot">&lt;-</span> proposed</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>    }</span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>    samples[i] <span class="ot">&lt;-</span> current</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>  }</span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>}</span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings</span>(num_samples)</span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a>samples <span class="ot">&lt;-</span> samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)]</span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a>deciles_generated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a>deciles_cauchy <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Deciles of generated samples:</span><span class="sc">\n</span><span class="st">&quot;</span>, deciles_generated, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Deciles of standard Cauchy distribution:</span><span class="sc">\n</span><span class="st">&quot;</span>, deciles_cauchy, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a>samples_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Value =</span> samples)</span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a><span class="fu">ggplot</span>(samples_df, <span class="fu">aes</span>(<span class="at">x =</span> Value)) <span class="sc">+</span></span>
<span id="cb45-25"><a href="#cb45-25" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb45-26"><a href="#cb45-26" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dcauchy, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb45-27"><a href="#cb45-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Metropolis-Hastings Sampling from Standard Cauchy&quot;</span>,</span>
<span id="cb45-28"><a href="#cb45-28" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Value&quot;</span>,</span>
<span id="cb45-29"><a href="#cb45-29" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb45-30"><a href="#cb45-30" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-31"><a href="#cb45-31" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;topright&quot;</span>) <span class="sc">+</span></span>
<span id="cb45-32"><a href="#cb45-32" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">label =</span> <span class="st">&quot;Standard Cauchy PDF&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>Here are the results of the deciles obtained from the generated
samples compared to the standard Cauchy distribution.</p>
<table>
<colgroup>
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">Q1</th>
<th align="center">Q2</th>
<th align="center">Q3</th>
<th align="center">Q4</th>
<th align="center">Q5</th>
<th align="center">Q6</th>
<th align="center">Q7</th>
<th align="center">Q8</th>
<th align="center">Q9</th>
<th align="center">Q10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">generated samples</td>
<td align="center">-2.634386</td>
<td align="center">-1.074383</td>
<td align="center">-0.494804</td>
<td align="center">-0.1409595</td>
<td align="center">0.2144038</td>
<td align="center">0.5754213</td>
<td align="center">1.056696</td>
<td align="center">2.155424</td>
<td align="center">6.717301</td>
<td align="center">22.51901</td>
</tr>
<tr class="even">
<td align="center">standard Cauchy</td>
<td align="center">-3.077684</td>
<td align="center">-1.376382</td>
<td align="center">-0.7265425</td>
<td align="center">-0.3249197</td>
<td align="center">0</td>
<td align="center">0.3249197</td>
<td align="center">0.7265425</td>
<td align="center">1.376382</td>
<td align="center">3.077684</td>
<td align="center">Inf</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, num_samples) {</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">iteration =</span> <span class="dv">1</span><span class="sc">:</span>num_samples, <span class="at">x =</span> <span class="fu">numeric</span>(num_samples), <span class="at">y =</span> <span class="fu">numeric</span>(num_samples))</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>    samples[i, <span class="st">&quot;x&quot;</span>] <span class="ot">&lt;-</span> x</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a>    samples[i, <span class="st">&quot;y&quot;</span>] <span class="ot">&lt;-</span> y</span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>  }</span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>}</span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>  </span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span>   </span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span>   </span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n, a, b, num_samples)</span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a>samples_long <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(samples, <span class="at">id.vars =</span> <span class="st">&quot;iteration&quot;</span>)</span>
<span id="cb46-19"><a href="#cb46-19" tabindex="-1"></a><span class="fu">ggplot</span>(samples_long, <span class="fu">aes</span>(<span class="at">x =</span> iteration, <span class="at">y =</span> value, <span class="at">color =</span> variable, <span class="at">group =</span> variable)) <span class="sc">+</span></span>
<span id="cb46-20"><a href="#cb46-20" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-21"><a href="#cb46-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Gibbs Sampler Chains for x and y&quot;</span>,</span>
<span id="cb46-22"><a href="#cb46-22" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Iteration&quot;</span>,</span>
<span id="cb46-23"><a href="#cb46-23" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Value&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-24"><a href="#cb46-24" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;y&quot;</span> <span class="ot">=</span> <span class="st">&quot;lightgreen&quot;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;x Chain&quot;</span>, <span class="st">&quot;y Chain&quot;</span>)) <span class="sc">+</span></span>
<span id="cb46-25"><a href="#cb46-25" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb46-26"><a href="#cb46-26" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p>The plot displays the chains for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>metropolis_hastings <span class="ot">&lt;-</span> <span class="cf">function</span>(num_samples) {</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>  current <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>    proposed <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> current) </span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>    acceptance_ratio <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(proposed) <span class="sc">/</span> <span class="fu">dcauchy</span>(current)</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> acceptance_ratio) {</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>      current <span class="ot">&lt;-</span> proposed</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a>    }</span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a>    samples[i] <span class="ot">&lt;-</span> current</span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a>  }</span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a>}</span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="cf">function</span>(i) <span class="fu">metropolis_hastings</span>(num_samples)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)])</span>
<span id="cb48-17"><a href="#cb48-17" tabindex="-1"></a>chains_mcmc <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">lapply</span>(chains, mcmc))</span>
<span id="cb48-18"><a href="#cb48-18" tabindex="-1"></a>gelman_diag_mh <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(chains_mcmc, <span class="at">autoburnin =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-19"><a href="#cb48-19" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Gelman-Rubin Diagnostic:&quot;</span>)</span>
<span id="cb48-20"><a href="#cb48-20" tabindex="-1"></a><span class="fu">print</span>(gelman_diag_mh)</span></code></pre></div>
<p>It can be seen that the obtained Gelman-Rubin statistic and the upper
limit of the confidence interval are both less than 1.1, which is
fine.</p>
<p></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, num_samples) {</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">numeric</span>(num_samples), <span class="at">y =</span> <span class="fu">numeric</span>(num_samples))</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>    samples[i, <span class="st">&quot;x&quot;</span>] <span class="ot">&lt;-</span> x</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>    samples[i, <span class="st">&quot;y&quot;</span>] <span class="ot">&lt;-</span> y</span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>  }</span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>}</span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a>chains_gibbs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="cf">function</span>(i) <span class="fu">gibbs_sampler</span>(n, a, b, num_samples))</span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a>chains_x <span class="ot">&lt;-</span> <span class="fu">lapply</span>(chains_gibbs, <span class="cf">function</span>(chain) <span class="fu">mcmc</span>(chain<span class="sc">$</span>x))</span>
<span id="cb49-19"><a href="#cb49-19" tabindex="-1"></a>chains_y <span class="ot">&lt;-</span> <span class="fu">lapply</span>(chains_gibbs, <span class="cf">function</span>(chain) <span class="fu">mcmc</span>(chain<span class="sc">$</span>y))</span>
<span id="cb49-20"><a href="#cb49-20" tabindex="-1"></a>chains_x_mcmc <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(chains_x)</span>
<span id="cb49-21"><a href="#cb49-21" tabindex="-1"></a>chains_y_mcmc <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(chains_y)</span>
<span id="cb49-22"><a href="#cb49-22" tabindex="-1"></a>gelman_diag_gibbs_x <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(chains_x_mcmc, <span class="at">autoburnin =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-23"><a href="#cb49-23" tabindex="-1"></a>gelman_diag_gibbs_y <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(chains_y_mcmc, <span class="at">autoburnin =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-24"><a href="#cb49-24" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Gelman-Rubin Diagnostic for X:&quot;</span>)</span>
<span id="cb49-25"><a href="#cb49-25" tabindex="-1"></a><span class="fu">print</span>(gelman_diag_gibbs_x)</span>
<span id="cb49-26"><a href="#cb49-26" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Gelman-Rubin Diagnostic for Y:&quot;</span>)</span>
<span id="cb49-27"><a href="#cb49-27" tabindex="-1"></a><span class="fu">print</span>(gelman_diag_gibbs_y)</span></code></pre></div>
<p>The Gelman-Rubin statistic and the upper limit of the confidence
interval for both <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are also less than 1.1, which is
fine.</p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<ul>
<li><p>When <span class="math inline">\(s \neq r\)</span>: <span class="math display">\[
K(r, s) = \alpha(r, s) g(s | r)
\]</span></p></li>
<li><p>When <span class="math inline">\(s = r\)</span>: <span class="math display">\[
K(r, s) = 1 - \int \alpha(r, s) g(s | r) \, ds
\]</span></p></li>
</ul>
<p>The acceptance probability is defined as: <span class="math display">\[
\alpha(s, r) = \min \left\{ \frac{f(r) g(s | r)}{f(s) g(r | s)}, 1
\right\}
\]</span></p>
<p>If <span class="math inline">\(f(r) g(s | r) \geq f(s) g(r |
s)\)</span>, then <span class="math inline">\(\alpha(s, r) = 1\)</span>;
otherwise, if <span class="math inline">\(f(r) g(s | r) &lt; f(s) g(r |
s)\)</span>, then <span class="math display">\[
\alpha(s, r) = \frac{f(r) g(s | r)}{f(s) g(r | s)}
\]</span></p>
<p>To prove stationarity, i.e., that <span class="math inline">\(K(s, r)
f(s) = K(r, s) f(r)\)</span>, we compute each side separately.</p>
<ul>
<li><p><strong><span class="math inline">\(K(s, r)
f(s)\)</span></strong>:</p>
<p>When <span class="math inline">\(s \neq r\)</span>, <span class="math display">\[
K(s, r) f(s) = \alpha(s, r) g(r | s) f(s)
\]</span> Substituting in <span class="math inline">\(\alpha(s,
r)\)</span>, we obtain: <span class="math display">\[
K(s, r) f(s) = \min \left\{ f(r) g(s | r), f(s) g(r | s) \right\}
\]</span></p></li>
<li><p><strong><span class="math inline">\(K(r, s)
f(r)\)</span></strong>:</p>
<p>Similarly, for <span class="math inline">\(K(r, s) f(r)\)</span>, we
obtain the same result: <span class="math display">\[
K(r, s) f(r) = \min \left\{ f(r) g(s | r), f(s) g(r | s) \right\}
\]</span></p></li>
</ul>
<p>This completes the proof.</p>
</div>
</div>
<div id="homework-2024.11.04" class="section level2">
<h2>Homework-2024.11.04</h2>
<div id="question-7" class="section level3">
<h3>Question</h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>(a). Write a function to compute the <span class="math inline">\(k\)</span>th term in <span class="math display">\[
   \sum_{k=0}^{\infty} \frac{(-1)^k}{k! \cdot 2^k} \frac{\| a \|^{2k +
2}}{(2k + 1)(2k + 2)} \frac{\Gamma \left( \frac{d+1}{2} \right) \Gamma
\left( k + \frac{3}{2} \right)}{\Gamma \left( k + \frac{d}{2} + 1
\right)},
   \]</span> where <span class="math inline">\(d \geq 1\)</span> is an
integer, <span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^d\)</span>, and <span class="math inline">\(\| \cdot \|\)</span> denotes the Euclidean norm.
Perform the arithmetic so that the coefficients can be computed for
(almost) arbitrarily large <span class="math inline">\(k\)</span> and
<span class="math inline">\(d\)</span>. (This sum converges for all
<span class="math inline">\(a \in \mathbb{R}^d\)</span>.)</p>
<p>(b). Modify the function so that it computes and returns the sum.</p>
<p>(c). Evaluate the sum when <span class="math inline">\(a =
\begin{pmatrix} 1 \\ 2 \end{pmatrix}\)</span>.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Write a function to solve the equation <span class="math display">\[
\frac{2 \Gamma \left( \frac{k}{2} \right)}{\sqrt{\pi} (k - 1) \Gamma
\left( \frac{k - 1}{2} \right)} \int_0^{c_{k-1}} \left( 1 + \frac{u^2}{k
- 1} \right)^{-k/2} \, du = \frac{2 \Gamma \left( \frac{k+1}{2}
\right)}{\sqrt{\pi k} \Gamma \left( \frac{k}{2} \right)} \int_0^{c_k}
\left( 1 + \frac{u^2}{k} \right)^{-(k+1)/2} \, du
\]</span> for <span class="math inline">\(a\)</span>, where <span class="math display">\[
c_k = \sqrt{\frac{a^2 k}{k + 1 - a^2}}.
\]</span> Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>Suppose <span class="math inline">\(T_1,\dots,T_n\)</span> are <span class="math inline">\(i.i.d.\)</span> samples drawn from the exponential
distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right
censorship, so that the observed values are <span class="math inline">\(Y_i = T_i I(T_i \leq \tau) + \tau I(T_i &gt;
\tau), \, i= 1,\dots,n\)</span>. Suppose <span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[
0.54, 0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85
\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the
observed data MLE (note: <span class="math inline">\(Y_i\)</span>
follows a mixture distribution).</p>
</div>
<div id="solution-3" class="section level3">
<h3>Solution</h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>(a).</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>compute_k <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a, d) {</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>)) </span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> ((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">/</span> (<span class="fu">factorial</span>(k) <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>k)) <span class="sc">*</span> (norm_a<span class="sc">^</span>(<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>)) <span class="sc">/</span> ((<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>))</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> <span class="fu">gamma</span>((d <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">+</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">gamma</span>(k <span class="sc">+</span> d <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>  result <span class="ot">&lt;-</span> part1 <span class="sc">*</span> part2</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>}</span></code></pre></div>
<p>We define the function to compute the <span class="math inline">\(k\)</span>th term in the given series:</p>
<p>(b).</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>compute_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(a, d, <span class="at">max =</span> <span class="dv">150</span>) {</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>max) {</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>    s <span class="ot">&lt;-</span> s <span class="sc">+</span> <span class="fu">compute_k</span>(k, a, d)</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>  }</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>}</span></code></pre></div>
<p>The function is used to calculate the infinite sum, approximated with
a finite upper limit . The default maximum number of terms, =150, is set
to avoid large values of <span class="math inline">\(k\)</span>, which
would cause the denominator of the <span class="math inline">\(k\)</span>-th term to become too large, resulting
in a value during computation.</p>
<p>(c).</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">compute_sum</span>(a, d)</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<p>When <span class="math inline">\(a=(1,2)^T\)</span> and <span class="math inline">\(d=2\)</span>, the function call yields the result
1.532164.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>First, we consider the intersection of two curves in Exercise 11.4 at
<span class="math inline">\((0,\sqrt{k})\)</span>: <span class="math display">\[
S_{k-1}(a) = P \left( t(k - 1) &gt; \sqrt{\frac{a^2 (k - 1)}{k - a^2}}
\right)
\]</span></p>
<p><span class="math display">\[
S_k(a) = P \left( t(k) &gt; \sqrt{\frac{a^2 k}{k + 1 - a^2}} \right).
\]</span></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>intersection <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>  curve_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(a) <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>( <span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">/</span> (k <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>)) , <span class="at">df =</span> k <span class="sc">-</span> <span class="dv">1</span> )</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>  curve_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(a) <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>( <span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k) <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>)) , <span class="at">df =</span> k )</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>  intersection <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="cf">function</span>(x) <span class="fu">curve_1</span>(x) <span class="sc">-</span> <span class="fu">curve_2</span>(x), <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="dv">2</span>)</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>  <span class="fu">return</span>(intersection<span class="sc">$</span>root)</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>}</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>points <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k_values))</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k_values)){</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>  points[i] <span class="ot">&lt;-</span> <span class="fu">intersection</span>(k_values[i])</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>}</span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>solve_equation <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>    <span class="fu">uniroot</span>(equation_diff, <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="fu">sqrt</span>(k) <span class="sc">-</span> <span class="fl">1e-6</span>, <span class="at">k =</span> k)</span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)  </span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a>  })</span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a>  </span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(result)) {</span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>) </span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a>  }</span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a>  </span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a>  <span class="fu">return</span>(result<span class="sc">$</span>root)</span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a>}</span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a><span class="fu">names</span>(points) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;A(&quot;</span>, k_values, <span class="st">&quot;)&quot;</span>)</span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a><span class="fu">print</span>(points)</span></code></pre></div>
<p>Here, since the root-finding interval is the open interval <span class="math inline">\((0,\sqrt{k})\)</span>，when using , the upper
limit is set as and the lower limit as .</p>
<p>Now, consider Problem 11.5:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>integrate_part <span class="ot">&lt;-</span> <span class="cf">function</span>(c, k) {</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>  integral <span class="ot">&lt;-</span> <span class="fu">integral</span>(<span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> (u<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>), <span class="dv">0</span>, c)</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>  <span class="fu">return</span>(integral)</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>}</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>c_k <span class="ot">&lt;-</span> <span class="cf">function</span>(k,a){</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">sqrt</span>( a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span>( k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span> ) )</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>}</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>eq <span class="ot">&lt;-</span> <span class="cf">function</span>(k,a){</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="fu">c_k</span>(k,a)</span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> ( <span class="fu">sqrt</span>( pi <span class="sc">*</span> k ) <span class="sc">*</span> <span class="fu">gamma</span>( k <span class="sc">/</span> <span class="dv">2</span> ) ) <span class="sc">*</span> <span class="fu">integrate_part</span>(c,k)</span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>}</span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>intersection_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(k){</span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a>  lhs <span class="ot">&lt;-</span> <span class="cf">function</span>(a) <span class="fu">eq</span>(k<span class="dv">-1</span>,a)</span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a>  rhs <span class="ot">&lt;-</span> <span class="cf">function</span>(a) <span class="fu">eq</span>(k,a)</span>
<span id="cb54-17"><a href="#cb54-17" tabindex="-1"></a>  intersection <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="cf">function</span>(x) <span class="fu">lhs</span>(x) <span class="sc">-</span> <span class="fu">rhs</span>(x), <span class="at">lower =</span> <span class="dv">1</span><span class="fl">+1e-1</span>, <span class="at">upper =</span> <span class="fl">1.8</span>)</span>
<span id="cb54-18"><a href="#cb54-18" tabindex="-1"></a>  <span class="fu">return</span>(intersection<span class="sc">$</span>root)</span>
<span id="cb54-19"><a href="#cb54-19" tabindex="-1"></a>}</span>
<span id="cb54-20"><a href="#cb54-20" tabindex="-1"></a>k_values_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>) </span>
<span id="cb54-21"><a href="#cb54-21" tabindex="-1"></a>points_1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k_values_1))</span>
<span id="cb54-22"><a href="#cb54-22" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k_values_1)){</span>
<span id="cb54-23"><a href="#cb54-23" tabindex="-1"></a>  points_1[i] <span class="ot">&lt;-</span> <span class="fu">intersection_1</span>(k_values_1[i])</span>
<span id="cb54-24"><a href="#cb54-24" tabindex="-1"></a>}</span>
<span id="cb54-25"><a href="#cb54-25" tabindex="-1"></a><span class="fu">names</span>(points_1) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;A(&quot;</span>, k_values_1, <span class="st">&quot;)&quot;</span>)</span>
<span id="cb54-26"><a href="#cb54-26" tabindex="-1"></a><span class="fu">print</span>(points_1)</span></code></pre></div>
<p>In 11.5, we set , since larger values of <span class="math inline">\(k\)</span> result in infinite values when
calculating <span class="math inline">\(\Gamma(\cdot)\)</span>. As we
can observe, the solutions obtained are approximately the same as the
results in 11.4.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>error <span class="ot">&lt;-</span> points_1 <span class="sc">-</span> points[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(points_1)]</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a><span class="fu">print</span>(error)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>In this problem, we cannot fully observe the true value of each
sample <span class="math inline">\(T_i\)</span>, so we need to use the
EM algorithm to handle the unobserved part and estimate the parameter
<span class="math inline">\(\lambda\)</span> .</p>
<p>First, we define the log-likelihood function:</p>
<p>Let</p>
<ul>
<li><p><span class="math inline">\(\mathcal{O} = \{ i \mid Y_i &lt; \tau
\}\)</span>: the index set of uncensored samples.</p></li>
<li><p><span class="math inline">\(\mathcal{M} = \{ i \mid Y_i = \tau
\}\)</span>: the index set of censored samples.</p></li>
</ul>
<p>Then, the log-likelihood function is: <span class="math display">\[
\log L(\lambda) = \sum_{i \in \mathcal{O}} \log f(Y_i; \lambda) +
\sum_{i \in \mathcal{M}} \log P(T_i &gt; \tau; \lambda),
\]</span> where, <span class="math inline">\(f(Y_i; \lambda) = \lambda
e^{- \lambda Y_i}\)</span> is the probability density function of <span class="math inline">\(T_i\)</span> under an exponential distribution,
and <span class="math inline">\(P(T_i &gt; \tau; \lambda) = e^{- \lambda
\tau  }\)</span>.</p>
<p>We use the EM algorithm, which proceeds as follows:</p>
<p>For censored samples <span class="math inline">\(Y_i =
\tau\)</span>，, we need to compute the conditional expectation of <span class="math inline">\(T_i\)</span> , <span class="math inline">\(\mathbb{E}[T_i \mid T_i &gt; \tau,
\lambda^{(k)}]\)</span>, given the current parameter estimate <span class="math inline">\(\lambda^{(k)}\)</span>: <span class="math display">\[
\begin{aligned}
\mathbb{E}[T_i \mid T_i &gt; \tau, \lambda^{(k)}]
&amp;=  \int_{\tau}^{\infty} x \, f(x \mid X &gt; \tau) \, dx \\
&amp; =  \int_{\tau}^{\infty} x \, \frac{f(x)}{P(X &gt; \tau)} I\{x &gt;
\tau\} \, dx \\
&amp; = \int_{\tau}^{\infty} x \cdot \lambda^{(k)} e^{-\lambda^{(k)} (x
- \tau)} \, dx \\
&amp; = \int_{0}^{\infty} (u + \tau) \lambda^{(k)} e^{-\lambda^{(k)} u}
\, du \\
&amp; =\tau + \frac{1}{\lambda^{(k)}}
\end{aligned}
\]</span></p>
<p>For uncensored samples <span class="math inline">\(i \in
\mathcal{O}\)</span>, we directly use<span class="math inline">\(Y_i\)</span>.</p>
<p>For censored samples <span class="math inline">\(i \in
\mathcal{M}\)</span>, we replace <span class="math inline">\(T_i\)</span> with its conditional expectation
<span class="math inline">\(\tau + \frac{1}{\lambda^{(k)}}\)</span>.</p>
<p>Update the estimate of <span class="math inline">\(\lambda^{(k)}\)</span> . <span class="math display">\[
\begin{aligned}
\lambda^{(k+1)} &amp;= \frac{1}{ \frac{\sum_{i \in \mathcal{O}} Y_i +
\sum_{i \in \mathcal{C}} \mathbb{E}[T_i \mid T_i &gt; \tau,
\lambda^{(k)}]}{n} } \\
&amp; = \frac{1}{ \frac{\sum_{i \in \mathcal{O}} Y_i + \sum_{i \in
\mathcal{C}} (\tau + \frac{1}{\lambda^{(k)}})}{n} }
\end{aligned}
\]</span></p>
<p>Set the initial value <span class="math inline">\(\lambda^{(0)} =
1\)</span>, then iteratively compute until <span class="math inline">\(\lambda\)</span> converges.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(T)</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>obs_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(T <span class="sc">&lt;</span> tau)  </span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>missing_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(T <span class="sc">==</span> tau) </span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fl">1e-6</span>  </span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>max_iter <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>diff <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># Set an initial difference</span></span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Set iteration counter</span></span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a><span class="cf">while</span> (diff <span class="sc">&gt;</span> error <span class="sc">&amp;&amp;</span> iter <span class="sc">&lt;</span> max_iter) {</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>  lambda_old <span class="ot">&lt;-</span> lambda</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>  ET_missing <span class="ot">&lt;-</span> tau <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> lambda</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> n <span class="sc">/</span> (<span class="fu">sum</span>(T[obs_indices]) <span class="sc">+</span> <span class="fu">length</span>(missing_indices) <span class="sc">*</span> ET_missing)</span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(lambda <span class="sc">-</span> lambda_old)</span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>}</span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;EM algorithm estimation:&quot;</span>, lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(T[obs_indices])</span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE estimation:&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>In this analysis, the difference between the EM algorithm estimate
and the maximum likelihood estimate based on uncensored data is
significant: The EM estimate yields <span class="math inline">\(\lambda_{\text{EM}} = 1.037037\)</span>, while the
maximum likelihood estimate based only on uncensored data is <span class="math inline">\(\lambda_{\text{MLE}} = 1.866667\)</span>.</p>
<ul>
<li><p>Since some of the samples in the observed data are right-censored
(i.e., <span class="math inline">\(T_i = 1\)</span>), the EM algorithm
fills in the values of these censored samples during the E-step using
the conditional expectation, which results in more accurate estimates
under censorship.</p></li>
<li><p>On the other hand, the direct calculation of <span class="math inline">\(\lambda_{\text{MLE}}\)</span> only considers
uncensored samples and ignores the censored samples, leading to an
overestimate.</p></li>
</ul>
</div>
</div>
<div id="homewrok-2024.11.11" class="section level2">
<h2>Homewrok-2024.11.11</h2>
<div id="question-8" class="section level3">
<h3>Question</h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>Use the simplex algorithm to solve the following problem.</p>
<p>Minimize <span class="math inline">\(4x + 2y + 9z\)</span> subject to
<span class="math display">\[
2x+y+z \leq 2
\]</span> <span class="math display">\[
x-y+3z \leq 3
\]</span> <span class="math display">\[
x \geq 0,\, y \geq0, \, z\geq 0.
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>(1).</p>
<p>Use both for loops and to fit linear models to the using the formulas
stored in this list:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>)</span></code></pre></div>
<p>(2).</p>
<p>Fit the model to each of the bootstrap replicates of in the list
below by using a for loop and . Can you do it without an anonymous
function?</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>})</span></code></pre></div>
<p>(3).</p>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>(1).</p>
<p>The following code simulates the performance of a t-test for
non-normal data. Use and an anonymous function to extract the p-value
from every trial.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a><span class="dv">100</span>,</span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a><span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>)</span></code></pre></div>
<p>Extra challenge: get rid of the anonymous function by using [[
directly.</p>
<p>(2).</p>
<p>Implement a combination of and to create an variant that iterates in
parallel over all of its inputs and stores its outputs in a vector (or a
matrix). What arguments should the function take?</p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>(1).</p>
<p>Make a faster version of that only computes the chi-square test
statistic when the input is two numeric vectors with no missing values.
You can try simplifying or by coding from the mathematical definition
(<a href="http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test" class="uri">http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test</a>)</p>
<p>(2).</p>
<p>Can you make a faster version of for the case of an input of two
integer vectors with no missing values? Can you use it to speed up your
chi-square test?</p>
</div>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>objective <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>constraints <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>direction <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>)</span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a>rhs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lp</span>(<span class="st">&quot;min&quot;</span>, objective, constraints, direction, rhs)</span>
<span id="cb61-7"><a href="#cb61-7" tabindex="-1"></a>result<span class="sc">$</span>solution </span>
<span id="cb61-8"><a href="#cb61-8" tabindex="-1"></a>result<span class="sc">$</span>objval   </span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>(1).</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>)</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a><span class="cf">for</span> (f <span class="cf">in</span> formulas) {</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(f, <span class="at">data =</span> mtcars)))</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>}</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a><span class="fu">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="fu">summary</span>(<span class="fu">lm</span>(f, <span class="at">data =</span> mtcars)))</span></code></pre></div>
<p>(2).</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>})</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a><span class="cf">for</span> (bootstrap <span class="cf">in</span> bootstraps) {</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstrap)))</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>}</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a><span class="fu">lapply</span>(bootstraps, <span class="cf">function</span>(bootstrap) <span class="fu">summary</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstrap)))</span></code></pre></div>
<p>(3).</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a><span class="cf">for</span> (f <span class="cf">in</span> formulas) {</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(f, <span class="at">data =</span> mtcars)</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">rsq</span>(mod))</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>}</span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="fu">rsq</span>(<span class="fu">lm</span>(f, <span class="at">data =</span> mtcars))))</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a><span class="cf">for</span> (bootstrap <span class="cf">in</span> bootstraps) {</span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstrap)</span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">rsq</span>(mod))</span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a>}</span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">lapply</span>(bootstraps, <span class="cf">function</span>(bootstrap) <span class="fu">rsq</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstrap))))</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>(1).</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>)</span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="sc">$</span>p.value)</span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a>p_values</span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials,<span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a>p_values</span></code></pre></div>
<p>(2).</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>parallel_lapply <span class="ot">&lt;-</span> <span class="cf">function</span>(X, FUN, ...) {</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">Map</span>(FUN, X, ...)</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>  <span class="fu">vapply</span>(result, <span class="at">FUN =</span> identity, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>}</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>inputs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a><span class="fu">parallel_lapply</span>(inputs, sum)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>(1).</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>better_chisq <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>  observed <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>  chisq_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> <span class="fu">mean</span>(observed))<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">mean</span>(observed))</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>  <span class="fu">return</span>(chisq_stat)</span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>}</span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a><span class="fu">better_chisq</span>(x, y)</span></code></pre></div>
<p>(2).</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>better_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>  table_result <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>  <span class="fu">return</span>(table_result)</span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>}</span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a><span class="fu">better_table</span>(x, y)</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>observed <span class="ot">&lt;-</span> <span class="fu">better_table</span>(x, y)</span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>chisq_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> <span class="fu">mean</span>(observed))<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">mean</span>(observed))</span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a>chisq_stat</span></code></pre></div>
</div>
</div>
<div id="homework-2024.11.18" class="section level2">
<h2>Homework-2024.11.18</h2>
<div id="question-9" class="section level3">
<h3>Question</h3>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x,y) \propto \binom{n}{x} y^{x+a-1} (1-y)^{n-x+b-1},\quad
x=0,1,\dots,n, \, 0 \leq y \leq1.
\]</span> It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a\)</span>,<span class="math inline">\(b\)</span>,<span class="math inline">\(n\)</span>,
the conditional distributions are Binomial(<span class="math inline">\(n, y\)</span>) and Beta(<span class="math inline">\(x + a, n − x + b\)</span>). Use the Gibbs sampler
to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
</div>
<div id="answer-5" class="section level3">
<h3>Answer</h3>
<p>Clear Variable Space.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>The specific <code>Rcpp</code> functions are as follows.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a><span class="st">  DataFrame gibbs_sampler_C(int n, double a, double b, int num_samples) {</span></span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a><span class="st">  NumericVector x(num_samples);</span></span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a><span class="st">  NumericVector y(num_samples);</span></span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a><span class="st">  int current_x = 0;</span></span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a><span class="st">  for (int i = 0; i &lt; num_samples; i++) {</span></span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a><span class="st">    y[i] = R::rbeta(current_x + a, n - current_x + b);</span></span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a><span class="st">    current_x = R::rbinom(n, y[i]);</span></span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a><span class="st">    x[i] = current_x;</span></span>
<span id="cb70-12"><a href="#cb70-12" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb70-13"><a href="#cb70-13" tabindex="-1"></a><span class="st">  return DataFrame::create(Named(&quot;iteration&quot;) = seq(1, num_samples),</span></span>
<span id="cb70-14"><a href="#cb70-14" tabindex="-1"></a><span class="st">                           Named(&quot;x&quot;) = x,</span></span>
<span id="cb70-15"><a href="#cb70-15" tabindex="-1"></a><span class="st">                           Named(&quot;y&quot;) = y);</span></span>
<span id="cb70-16"><a href="#cb70-16" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb70-17"><a href="#cb70-17" tabindex="-1"></a><span class="st">&#39;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>gibbs_sampler_R <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, num_samples) {</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">iteration =</span> <span class="dv">1</span><span class="sc">:</span>num_samples, <span class="at">x =</span> <span class="fu">numeric</span>(num_samples), <span class="at">y =</span> <span class="fu">numeric</span>(num_samples))</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>    samples[i, <span class="st">&quot;x&quot;</span>] <span class="ot">&lt;-</span> x</span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>    samples[i, <span class="st">&quot;y&quot;</span>] <span class="ot">&lt;-</span> y</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a>  }</span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a>}</span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a><span class="co">#library(Rcpp)</span></span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a><span class="co">#dir_cpp &lt;- &#39;../Rcpp/&#39;</span></span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a><span class="co">#sourceCpp(paste0(dir_cpp,&quot;Gibbs_sampler_C.cpp&quot;)) </span></span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a></span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>  </span>
<span id="cb71-18"><a href="#cb71-18" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span>   </span>
<span id="cb71-19"><a href="#cb71-19" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb71-20"><a href="#cb71-20" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb71-21"><a href="#cb71-21" tabindex="-1"></a></span>
<span id="cb71-22"><a href="#cb71-22" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb71-23"><a href="#cb71-23" tabindex="-1"></a>samples_R <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler_R</span>(n, a, b, num_samples)</span>
<span id="cb71-24"><a href="#cb71-24" tabindex="-1"></a>samples_C <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler_C</span>(n, a, b, num_samples)</span>
<span id="cb71-25"><a href="#cb71-25" tabindex="-1"></a>samples_long_R <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(samples_R, <span class="at">id.vars =</span> <span class="st">&quot;iteration&quot;</span>)</span>
<span id="cb71-26"><a href="#cb71-26" tabindex="-1"></a>samples_long_C <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(samples_C, <span class="at">id.vars =</span> <span class="st">&quot;iteration&quot;</span>)</span>
<span id="cb71-27"><a href="#cb71-27" tabindex="-1"></a></span>
<span id="cb71-28"><a href="#cb71-28" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb71-29"><a href="#cb71-29" tabindex="-1"></a><span class="fu">qqplot</span>(samples_R<span class="sc">$</span>x, samples_C<span class="sc">$</span>x, <span class="at">main =</span> <span class="st">&quot;QQ Plot of x&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;R&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;C&quot;</span>, <span class="at">pch =</span> <span class="dv">8</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb71-30"><a href="#cb71-30" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="fl">1.8</span>)</span>
<span id="cb71-31"><a href="#cb71-31" tabindex="-1"></a><span class="fu">qqplot</span>(samples_R<span class="sc">$</span>y, samples_C<span class="sc">$</span>y, <span class="at">main =</span> <span class="st">&quot;QQ Plot of y&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;R&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;C&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">cex =</span> <span class="fl">0.1</span>)</span>
<span id="cb71-32"><a href="#cb71-32" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="fl">1.8</span>)</span></code></pre></div>
<p>A QQ plot is used to compare the consistency of distributions between
two datasets. From the plot, we observe that the data points are close
to <span class="math inline">\(y = x\)</span>, indicating that the
distributions of the two datasets are very similar. When the curve is
slightly above <span class="math inline">\(y = x\)</span>, it suggests
that the data generated by C++ is slightly higher in certain regions
compared to the data generated by R. This discrepancy might be caused by
differences in random number seeds, floating-point arithmetic, or subtle
implementation variations.</p>
<p>Overall, the random number distributions generated by the Gibbs
sampling functions implemented in R and C++ are highly consistent.</p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>  <span class="at">gibbsR =</span> <span class="fu">gibbs_sampler_R</span>(n, a, b, num_samples),</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>  <span class="at">gibbsC =</span> <span class="fu">gibbs_sampler_C</span>(n, a, b, num_samples)</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>)</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a><span class="fu">summary</span>(ts)[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>)]</span></code></pre></div>
<p>The median runtime of <code>gibbsR</code> is 42,223.45 ns, which is
significantly higher than the 560.90 ns of <code>gibbsC</code>. This
means the C++ implementation of Gibbs sampling is approximately 75 times
faster than the R implementation. This performance difference arises
because C++ executes compiled code with higher efficiency, while R, as
an interpreted language, performs slower in loops and computationally
intensive tasks.</p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>The <code>Rcpp</code> Gibbs sampling function significantly
outperforms the R implementation in terms of runtime efficiency. For
tasks requiring a large number of iterations (e.g., Markov Chain Monte
Carlo) or dealing with large datasets, C++ is the better choice. R’s
loops and complex computations are slower. However, the sample
distributions generated by both methods are similar, indicating
consistent implementation logic. Therefore, it is recommended to use the
<code>Rcpp</code> implementation in scenarios with high-performance
requirements while leveraging R’s ease of use for initial testing and
debugging.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
